{# templates/view.html #}
{% extends "base.html" %}

{% block content %}
  <!-- JS constant for default cuisine image -->
  <script>
    const DEFAULT_CUISINE_IMG = "{{ url_for('static', filename='images/cuisines/default.jpg') }}";
  </script>

  <div class="container my-5">
    <div class="card shadow-sm">

      {# Normalize the cuisine tag into a matching filename: lowercase + hyphens #}
      {% set img_name = recipe.cuisine | lower | replace(' ', '-') ~ '.jpg' %}

      <img
        src="{{ url_for('static', filename='images/cuisines/' ~ img_name) }}"
        class="card-img-top"
        alt="{{ recipe.cuisine | title }}"
        onerror="this.onerror=null; this.src=DEFAULT_CUISINE_IMG;"
      >

      <div class="card-body">
        <h2 class="card-title">{{ recipe.name }}</h2>
        <p class="text-muted">{{ recipe.description }}</p>

        <ul class="list-inline mb-3">
          <li class="list-inline-item"><strong>â±</strong> {{ recipe.minutes }} min</li>
          <li class="list-inline-item"><strong>ğŸ”¥</strong> {{ recipe.nutrition.calories }} cal</li>
          {% for key, val in recipe.nutrition.items() if key != 'calories' %}
            <li class="list-inline-item">
              <strong>{{ key.replace('_',' ').title() }}:</strong> {{ val }}
            </li>
          {% endfor %}
        </ul>

        <h5>ğŸ¥— Ingredients</h5>
        <ul class="mb-4">
          {% for ing in recipe.ingredients %}
            <li>{{ ing }}</li>
          {% endfor %}
        </ul>

        <h5>ğŸ‘©â€ğŸ³ Steps</h5>
        <ol class="mb-4">
          {% for step in recipe.steps %}
            <li>{{ step }}</li>
          {% endfor %}
        </ol>

        <a href="{{ request.referrer or url_for('main') }}" class="btn btn-outline-secondary">
          â† Back
        </a>
      </div>
    </div>
  </div>
{% endblock %}
